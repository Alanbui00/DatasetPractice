filter(original_air_year == 2000)
head(year2000rating8)
View(year2000rating8)
#3. Write a query to retrieve all episodes that aired in the year 2000 with an IMDb rating above 7.0.
#head(simpsons_episodes)
#colnames(simpsons_episodes)
year2000rating7 <- simpsons_episodes %>%
select(id, imdb_rating, original_air_year, title, season) %>%
filter(original_air_year == 2000)
head(year2000rating7)
#3. Write a query to retrieve all episodes that aired in the year 2000 with an IMDb rating above 7.0.
#head(simpsons_episodes)
#colnames(simpsons_episodes)
year2000rating7 <- simpsons_episodes %>%
select(id, imdb_rating, original_air_year, title, season) %>%
filter(original_air_year == 2000)
head(year2000rating7)
View(year2000rating7)
View(year2000rating8)
#3. Write a query to retrieve all episodes that aired in the year 2010 with an IMDb rating above 7.0.
#head(simpsons_episodes)
#colnames(simpsons_episodes)
year2010rating7 <- simpsons_episodes %>%
select(id, imdb_rating, original_air_year, title, season) %>%
filter(original_air_year == 2010)
head(year2010rating7)
#3. Write a query to retrieve all episodes that aired in the year 2010 with an IMDb rating above 7.0.
#head(simpsons_episodes)
#colnames(simpsons_episodes)
year2010rating7 <- simpsons_episodes %>%
select(id, imdb_rating, original_air_year, title, season) %>%
filter(original_air_year == 2010 & imdb_rating > 7.0)
head(year2010rating7)
#3. Write a query to retrieve all episodes that aired in the year 2010 with an IMDb rating above 7.0.
#head(simpsons_episodes)
#colnames(simpsons_episodes)
year2010rating7 <- simpsons_episodes %>%
select(id, imdb_rating, original_air_year, title, season) %>%
filter(original_air_year == 2010 & imdb_rating > 7.0)
head(year2010rating7)
#which season has the best average rating
head(simpsons_episodes)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season)
head(bestRating)
View(bestRating)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season)
head(bestRating)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season)
head(bestRating)
View(bestRating)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season) %>%
summarise(avg_rating = mean(imdb_rating, na.rm = TRUE))
head(bestRating)
head(bestRating)
ggplot(bestRating, aes(x = season, y = avg_rating)) +
geom_bar()
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season) %>%
summarise(avg_rating = mean(imdb_rating, na.rm = TRUE))
ggplot(bestRating, aes(x = season, y = avg_rating)) +
geom_col()
head(bestRating)
#which season has the best average rating
head(simpsons_episodes)
bestRating <- simpsons_episodes %>%
select(imdb_rating, season, title) %>%
group_by(season) %>%
summarise(avg_rating = mean(imdb_rating, na.rm = TRUE))
ggplot(bestRating, aes(x = factor(season), y = avg_rating)) +
geom_col()
head(bestRating)
ggplot(bestRating, aes(x = factor(season), y = avg_rating)) +
geom_col(fill = "steelblue") +
labs(title = "Average rating per Seasons",
x = "Season",
y = "Rating") +
theme_classic()
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
ratingTimeseries <- simpsons_episodes
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
ggplot(simpsons_episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
ggplot(simpsons_episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
ggplot(simpsons_episodes, aes(x = as.Date(original_air_date), y = imdb_rating)) +
geom_point()
lm()
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
ggplot(simpsons_episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
ggplot(simpsons_episodes, aes(x = as.Date(original_air_date), y = imdb_rating)) +
geom_point()
is.na(simpsons_episodes)
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
episodes <- simpsons_episodes
ggplot(episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
ggplot(episodes, aes(x = as.Date(original_air_date), y = imdb_rating)) +
geom_point()
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
episodes <- simpsons_episodes
episodes <- na.omit(episodes)
ggplot(episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
ggplot(episodes, aes(x = as.Date(original_air_date), y = imdb_rating)) +
geom_point()
# 7 What are some key trends you could explore in Simpsons' episode ratings over the years?
episodes <- simpsons_episodes
episodes <- na.omit(episodes)
ggplot(episodes, aes(x = original_air_date, y = imdb_rating)) +
geom_line()
ggplot(episodes, aes(x = as.Date(original_air_date), y = imdb_rating)) +
geom_point(alpha = .5, color = "yellow") +
geom_smooth(method = "lm", color = "blue", se = TRUE) +
labs(title = "Ratings over year linear model",
x = "Year",
y = "Ratings") +
theme_minimal()
#8 How would you visualize the most frequently spoken words in the scripts?
install.packages(tm)
#8 How would you visualize the most frequently spoken words in the scripts?
install.packages("tm")
#8 How would you visualize the most frequently spoken words in the scripts?
#install.packages("tm")
library(tm)
install.packages("wordcloud")
library(wordcloud)
R.version.string
install.packages("installr")
installr::updateR()
library(wordcloud)
View(simpsons_characters)
View(script_characters)
colnames(simpsons_script_lines)
# preprocess data
script_text <- simpsons_script_lines$normalized_text
script_text
script_text <- na.omit(script_text)
is.na(script_text)
#8 How would you visualize the most frequently spoken words in the scripts?
#install.packages("tm")
library(tm)
#install.packages("wordcloud")
library(wordcloud)
# preprocess data
script_text <- simpsons_script_lines$normalized_text
script_text <- na.omit(script_text)
preprocess <- function(text){
text <- tolower(text)
text <- removePunctuation(text)
text <- removeNumbers(text)
text <- removeWords(text, stopwords(kind = "en"))
}
script_text <- preprocess(script_text)
words.vec <- VectorSource(script_text)
View(words.vec)
View(words.vec)
words.vec <- VectorSource(script_text)
words.corpus <- Corpus(words.vec)
words.corpus
tdm <- TermDocumentMatrix(words.corpus)
m <- as.matrix(tdm)
wordcount <- rowSums(m)
head(wordcount)
wordcount <- sort(wordcount, decreasing = TRUE)
wordcloud(names(wordcount), wordcound)
wordcloud(names(wordcount), wordcount)
preprocess <- function(text){
text <- tolower(text)
text <- removePunctuation(text)
text <- removeNumbers(text)
text <- removeWords(text, stopwords(kind = "en"))
return(text)
}
script_text <- sapply(script_text, preprocess)
script_text <- sapply(script_text, preprocess)
words.vec <- VectorSource(script_text)
words.corpus <- Corpus(words.vec)
words.corpus
tdm <- TermDocumentMatrix(words.corpus)
m <- as.matrix(tdm)
wordcount <- rowSums(m)
head(wordcount)
wordcount <- sort(wordcount, decreasing = TRUE)
wordcloud(names(wordcount), wordcount, max.words = 100, colors = brewer.pal(8, "Dark2"))
View(simpsons_script_lines)
#9 How would you determine which character has the most spoken lines in the series?
charaText <- simpsons_script_lines$raw_character_text
head(charaText)
charaText <- na.omit(charaText)
head(charaText)
spoken <- count(charaText, sort = TRUE)
spoken <- simpsons_script_lines %>%
filter(spoken_lines == TRUE)
spoken <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
spoken <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
group_by(raw_character_text) %>%
summarise(total_lines = n()) %>%
arrange(desc(total_lines))
head(spoken, 10)
View(episodes)
View(script_characters)
View(simpsons_script_lines)
View(simpsons_locations)
View(simpsons_episodes)
View(simpsons_characters)
View(simpsons_script_lines)
View(simpsons_characters)
View(script_characters)
#10 Using Pandas, how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text)
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
count(raw_character_text)
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
count(raw_character_text, sort = TRUE)
View(appear)
?count
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc())
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc()) %>%
slice(1)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc(n_distinct)) %>%
slice(1)
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc(n_distinct(episode_id))) %>%
slice(1)
colnames(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc()) %>%
slice(1)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
'''
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc(n_distinct(episode_id))) %>%
slice(1)
'''
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames(appear)
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc(n))
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
#10 how would you find the character who appeared in the most episodes?
appear2 <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
View(appear2)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id))
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n_distinct(episode_id)) %>%
arrange(desc(n))
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n))
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text))
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n))
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text)) %>%  # Remove NA values
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%  # Count unique episodes per character
arrange(desc(n))  # Sort in descending order
colnames(appear)
colnames2 <- c("text", "n")
colnames(appear) <- colnames2
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text))
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n))
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text)) %>%
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n))
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text)) %>%
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n)) %>%
slice_max(3)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text)) %>%
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n)) %>%
slice(3)
View(appear)
#10 how would you find the character who appeared in the most episodes?
appear <- simpsons_script_lines %>%
filter(!is.na(raw_character_text)) %>%
group_by(raw_character_text) %>%
summarise(n = n_distinct(episode_id)) %>%
arrange(desc(n))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
head(words)
View(words)
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
summarise(mean_words = mean(word_count))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
summarise(mean(word_count))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
summarise(avg = mean(word_count))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
summarise(avg = mean(word_count))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE) %>%
summarise(avg = mean(word_count, na.rm = TRUE))
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
summary(words)
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE)
words2 <- simpsons_script_lines %>%
filter(word_count == 0)
summary(words)
View(words2)
#11 How would you calculate the average word count per line of dialogue?
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE & word_count != 0)
summary(words)
words <- simpsons_script_lines %>%
filter(speaking_line == TRUE & word_count != 0) %>%
summarise(avg = mean(word_count))
words
colnames(simpsons_episodes)
colnames(simpsons_script_lines)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))
View(script_characters)
View(scriptEp)
View(simpsons_characters)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))%>%
group_by(season)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))%>%
filter(word_count != NA) %>%
group_by(season) %>%
mutate(word_trend = mean())
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))%>%
filter(word_count != NA) %>%
group_by(season)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))%>%
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id"))
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id")) %>%
```
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id")) %>%
filter(speaking_line == TRUE & word_count != 0) %>%
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id")) %>%
filter(speaking_line == TRUE & word_count != 0)
View(scriptEp2)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id")) %>%
filter(speaking_line == TRUE & word_count != 0) %>%
group_by(season)
#12 How would you merge episode data with script lines to analyze word count trends per season?
scriptEp2 <- simpsons_script_lines %>%
left_join(simpsons_episodes, by = c("episode_id" = "id")) %>%
filter(speaking_line == TRUE & word_count != 0) %>%
group_by(season) %>%
summarise(wordTrend = mean(word_count))
install.packages("tidytuesdayR")
tuesdata <- tidytuesdayR::tt_load('2025-02-11')
